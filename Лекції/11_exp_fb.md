[Перейти до списку лекцій](README.md)

# Використання експертних функціональних блоків 

## Експерті входи/виходи

Логічний контролер M221 забезпечує:
Чотири швидкі входи (% I0.0,% I0.1,% I0.6 і% I0.7)
Два швидкі виходи контролерів, що містять транзисторні виходи (% Q0.0 і % Q0.1)
Чотири швидкі виходи у контролерів TM221C40U і TM221CE40U (% Q0.0,% Q0.1,% Q0.2 і% Q0.3)

Контролери з релейними виходами не містять швидких виходів.

### Експерті входи

![](media11/11_01.png)

`X `Функція доступна

– Функція не доступна

(1) %HSC2 доступна при конфігурації %HSC0 як Single Phase чи Not  Configured.`

(2)  %HSC3 доступна при конфігурації %HSC1 як Single Phase чи Not  Configured.

(3) `Функція PTO fДоступна у контролерів з транзисторними виходами.

### Експерті виходи

![](media11/11_02.png)



(1) Функція швидких виходів доступна лише  у контролерів з транзисторними виходами. 

(2) %PTO0 напрямок у режимі виходів [CW/CCW](javascript:void(0)), чи %PTO1 (не доступне якщо сконфігуровано %PTO0 у режимі виходів [CW/CCW](javascript:void(0)) ), чи %PTOx напрямок у інших випадках. 

(3) %Q0.2 і %Q0.3 швидкі виходи у контролерів  TM221C40U і TM221CE40U. 

(4) %PTO2 у контролерів  TM221C40U і TM221CE40U, чи %PTOx напрямок у інших випадках.  

(5) %PTO2 напрямок у режимі виходів [CW/CCW](javascript:void(0)) у контролерів TM221C40U і TM221CE40U, чи %PTO3 (не доступне якщо сконфігурован %PTO2 у режимі виходів [CW/CCW](javascript:void(0)) ) у контролерів TM221C40U і TM221CE40U, чи %PTOx напрямок у інших випадках.

## Fast Counter (Швидкий лічильник)

![](D:/git/PLCBeginner/Лекції/media11/fcnt_pic.png)

### Опис роботи

Функціональний блок Fast Counter виконує функції "лічильника вгору" або "лічильника вниз". Він може рахувати передні фронти цифрових входів частотою до 5 кГц в обчислювальному режимі з одним словом або з подвійним словом. Оскільки функціональні блоки Fast Counter управляються певними апаратними перериваннями, підтримка максимальної частоти дискретизації сигналу може змінюватися в залежності від конкретної програми та конфігурації обладнання.
Функціональні блоки Fast Counter % FC0, % FC1, % FC2 та % FC3 використовують визначені входи        % I0.2, % I0.3, % I0.4 та % I0.5 відповідно. Ці біти не зарезервовані виключно для Fast Counter, тому слід  враховувати, що вони можуть використовуватись іншими функціональними блоками.

| Параметр     | Можливі значення                    | Опис                                                         |
| ------------ | ----------------------------------- | ------------------------------------------------------------ |
| Used         | Використовується в програмі         | Якщо опція стоїть, цей функціональний блок (адреса) використовується в програмі |
| Address      | Адреса об'єкта (%FCi)               | Програма може вміщувати тільки обмежену кількість даних об'єктів. |
| Input        | %IO.i                               | Визначений вхід, пов'язаний з цим екземпляром функціонального блоку.  %IO.2...%IO.5 |
| Symbol       | Символьна назва                     | Символьна назва об'єкта, асоційованого  з швидким лічильником. |
| Configured   | Рахувати вверх чи вниз              | Можливі варіанти:                                                                               Не використовується                                                                      Рахувати вверх                                                                               Рахувати вниз |
| Preset       | Задане значення (%FCi.P чи %FCi.PD) | Може задаватись початкове значення:   Для режиму з одним словом через змінну %FCi.P  в діапазоні від 1 до 65535 ,  Для режиму з подвійним словом через змінну %FCi.PD в діапазоні від 1 до 4294967295. |
| Double  Word | Режим з подвійним словом            | Якщо опція стоїть, цей функціональний блок використовує режим з подвійним словом , інакше - з одним. |
| Comment      | Коментар                            | Створення коментаря, асоційованого  з швидким лічильником.   |

Функціональний блок швидкого лічильника має наступні входи/виходи: 

| Мітка | Значення                             | Опис                                                         |
| ----- | ------------------------------------ | ------------------------------------------------------------ |
| IN    | Вхід доступності                     | В стані "1" плинне значення оновлюється у відповідності до імпульсів на фізичному вході. В стані "0" плинне значення не змінюється. |
| R     | Вхід скидання лічильника             | Ініціалізація блоку. Якщо R дорівнює 1, встановлює плинне значення лічильника рівним 0 для лічильника вверх, встановлює значення %FC.P чи %FC.PD для лічильника вниз. Також онуляє вихід %FC.D. |
| D     | Індикатор досягнення уставки (вихід) | Виставляється в "1" якщо плинне значення %FCi.V чи %FCi.VD досягає значення уставки %FCi.P чи %FCi.PD для лічильника вверх, чи якщо плинне значення %FCi.V чи %FCi.VD досягають значення 0 для лічильника вниз. |

Fast Counters знаходяться в I/O Objects у розділі Tools  вкладки Programing.

Розглянемо роботу швидких лічильників на прикладі:

![](media11/11_05.png)

%FC0 змінюватиме плинне значення по фізичному входу %I0.2. Він налаштований як лічильник вверх, тому з кожним імпульсом на %I0.2 плинне значення (%FC0.VD) буде зростати на 1. При використанні режиму з подвійним словом значення уставки (%FC0.PD) можна виставити доволі великим.

%FC1 змінюватиме плинне значення по фізичному входу %I0.3. Він налаштований як лічильник вниз, тому з кожним імпульсом на %I0.3 плинне значення (%FC0.V) буде зменшуватись на 1. Використовується режим з одним словом і значення уставки (%FC0.P) виставлене рівним 30000.

Після конфігурації швидких лічильників використовуємо їх у програмі користувача.

![](media11/11_04.png)

У відповідності до програми, швидкий лічильник %FC0 доступний завжди (завжди рахуватиме імпульси %I0.2). Якщо контакт %М100 замкнеться,  плинне значення онулиться  (%FC0.VD=0) і індикатор досягнення уставки також стане False. Котушка %М101 замкнеться, коли плинне значення досягне уставки  (%FC0.VD=3000000000) при цьому індикатор досягнення уставки %FC0.D стане True.

Швидкий лічильник %FC1 доступний за умови, що контакт %М200 замкнений (рахуватиме імпульси %I0.3 при %М200=1 і не змінюватиме плинне значення при %М200=0). Якщо контакт %М201 замкнеться,  плинне значення проініціалізується  (%FC1.V=30000) і індикатор досягнення уставки стане False. Котушка %М202 замкнеться, коли плинне значення досягне 0  (%FC1.V=0) при цьому індикатор досягнення уставки %FC1.D стане True.